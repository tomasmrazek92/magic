"use strict";(()=>{var d=[],h=new Map,p={preview:{muted:!0,clickToPlay:!1,showOverlay:!0,controls:["play","progress","mute"],hideControls:!0},direct:{muted:!1,clickToPlay:!0,showOverlay:!1,controls:["play","progress","mute","fullscreen"],hideControls:!1},silent:{muted:!0,clickToPlay:!0,showOverlay:!1,controls:["play","progress"],hideControls:!1}};window.VideoSystem={init:y,initSwiper:g,playActiveSlide:V,pauseAll:u,modes:p,preload:a};function y(t=".plyr_video",i="preview",e=!0){e?m(t,i):$(t).each(function(){c($(this),i)})}function m(t,i){let e=new IntersectionObserver(n=>{n.forEach(o=>{if(o.isIntersecting){let s=$(o.target),l=h.get(o.target)||i;c(s,l),e.unobserve(o.target),h.delete(o.target)}})},{rootMargin:"100px",threshold:.1});$(t).each(function(){if(!$(this).data("plyr-initialized")){let n=$(this).parent().attr("data-video-mode")||i;h.set(this,n),e.observe(this)}})}function a(t,i="preview"){let e=$(t);e.length&&!e.data("plyr-initialized")&&c(e,i)}function r(t){if(t.data("attrs-set"))return;let i=t.parent(),e=i.attr("data-video-src"),n=i.attr("data-poster-src");n&&t.attr("poster",n),e&&t.attr("src",e),t.attr("preload","metadata"),t.data("attrs-set",!0)}function c(t,i="preview"){if(t.data("plyr-initialized"))return;r(t);let e=t.parent(),n=e.attr("data-video-mode")||i,o=p[n]||p.preview,s=new Plyr(t[0],{controls:o.controls,clickToPlay:o.clickToPlay,muted:o.muted,resetOnEnd:!0});s.on("ready",()=>{s.muted=o.muted,o.hideControls&&e.find(".plyr__controls").hide()}),d.push(s),t.data("plyr-initialized",!0),t.data("video-mode",n),S(e,s,o)}function g(t,i="preview",e=!0,n=!1){e?_(t,i,n):$(t.slides).find(".plyr_video").each(function(){r($(this)),c($(this),i)})}function _(t,i,e){let n=s=>{if(!s.length)return;let l=s.find(".plyr_video");l.length&&!l.data("plyr-initialized")&&(r(l),a(l,i))},o=s=>{if(!e)return;console.log(s);let f=$(s.slides[s.activeIndex]).find(".plyr_video");f.length&&w(f,i)};if(t.on("slideChange",function(){let s=$(this.slides[this.activeIndex]),l=$(this.slides[this.activeIndex+1]),f=$(this.slides[this.activeIndex-1]);[s,l,f].forEach(n),e&&o(this)}),t.on("afterInit",function(){$(this.slides).each(function(){let l=$(this).find(".plyr_video");l.length&&r(l)});let s=$(this.slides[this.activeIndex]).find(".plyr_video");s.length&&a(s,i),o(this)}),t.initialized){$(t.slides).each(function(){let l=$(this).find(".plyr_video");l.length&&r(l)});let s=$(t.slides[t.activeIndex]).find(".plyr_video");s.length&&a(s,i),o(t)}}function w(t,i){if(t.data("plyr-initialized")){let e=d.find(n=>n.media===t[0]);e&&i==="preview"&&(u(t),e.muted=!0,e.play().catch(()=>{}))}else{r(t),a(t,i);let e=(n=0)=>{if(n>20)return;let o=d.find(s=>s.media===t[0]);o&&o.ready?i==="preview"&&(u(),o.muted=!0,o.play().catch(()=>{})):setTimeout(()=>e(n+1),50)};setTimeout(()=>e(),200)}}function v(t){t.muted=!1,t.restart(),t.play()}function S(t,i,e){let n=t.closest('[data-plyr="component"]'),o=n.find('[data-plyr="overlay"]');if(!e.showOverlay){o.hide();return}o.on("click",function(){o.hide(),v(i),t.find(".plyr__controls").show()}),n.attr("data-plyr-play")==="hover"&&(n.on("mouseenter",function(){i.play(),e.showOverlay&&o.hide(),i.muted=!0,t.find(".plyr__controls").show()}),n.on("mouseleave",function(){i.pause(),e.showOverlay&&o.show(),i.restart(),i.muted=!0,e.hideControls&&t.find(".plyr__controls").hide()})),t.on("click",function(s){!$(s.target).closest(".plyr__controls").length&&!$(s.target).closest('[data-plyr="overlay"]').length&&(i.playing?i.pause():i.play())})}function u(t=null,i=!1){if(t){let e=$(t).closest("section"),n=[];e.find(".plyr_video").each(function(){if($(this).data("plyr-initialized")){let o=d.find(s=>s.media===this);if(o){let s=$(this).data("video-mode");(!i||s!=="preview")&&n.push(o)}}}),n.forEach(o=>{o.pause(),o.restart(),o.muted=!0}),i||(e.find('[data-plyr="overlay"]').show(),e.find(".plyr__controls").hide())}else d.forEach(e=>{let o=$(e.media).data("video-mode");(!i||o!=="preview")&&(e.pause(),e.restart(),e.muted=!0)}),i||($('[data-plyr="overlay"]').show(),$(".plyr__controls").hide())}function V(t,i){let e=$(t).find(".plyr_video").first();if(!e.length)return;if(!e.data("plyr-initialized")){let o=e.parent().attr("data-video-mode")||"preview";c(e,o)}let n=d.find(o=>o.media===e[0]);n&&(u(t),n.play(),i&&(v(n),$(t).find(".plyr__controls").show()))}$(document).ready(()=>y());})();
