"use strict";(()=>{var l=[],u=new Map,f={preview:{muted:!0,clickToPlay:!1,showOverlay:!0,controls:["play","progress","mute"],hideControls:!0},direct:{muted:!1,clickToPlay:!0,showOverlay:!1,controls:["play","progress","mute","fullscreen"],hideControls:!1},silent:{muted:!0,clickToPlay:!0,showOverlay:!1,controls:["play","progress"],hideControls:!1}},i={STOPPED:"stopped",PREVIEW:"preview",FULL:"full"};window.VideoSystem={init:h,initSwiper:_,playPreview:c,playFull:S,pauseSingle:P,pauseAll:p,modes:f,preload:g};function h(t=".plyr_video",a="preview",e=!0){e?v(t,a):$(t).each(function(){d($(this),a)})}function v(t,a){let e=new IntersectionObserver(n=>{n.forEach(o=>{if(o.isIntersecting){let r=$(o.target),s=u.get(o.target)||a;d(r,s),e.unobserve(o.target),u.delete(o.target)}})},{rootMargin:"100px",threshold:.1});$(t).each(function(){if(!$(this).data("plyr-initialized")){let n=$(this).parent().attr("data-video-mode")||a;u.set(this,n),e.observe(this)}})}function g(t,a="preview"){let e=$(t);e.length&&!e.data("plyr-initialized")&&d(e,a)}function y(t){if(t.data("attrs-set"))return;let a=t.parent(),e=a.attr("data-video-src"),n=a.attr("data-poster-src");n&&t.attr("poster",n),e&&t.attr("src",e),t.attr("preload","metadata"),t.data("attrs-set",!0)}function d(t,a="preview"){if(t.data("plyr-initialized"))return;y(t);let e=t.parent(),n=e.attr("data-video-mode")||a,o=f[n]||f.preview,r=new Plyr(t[0],{controls:o.controls,clickToPlay:o.clickToPlay,muted:o.muted,resetOnEnd:!0,hideControls:!1});r.on("ready",()=>{r.muted=o.muted,o.hideControls&&e.find(".plyr__controls").hide()}),r.on("play",()=>{t.data("play-state")===i.FULL&&p(t)}),r.on("ended",()=>{t.removeAttr("data-user-controlled"),t.data("play-state",i.STOPPED);let s=t.parent();s.closest('[data-plyr="component"]').find('[data-plyr="overlay"]').show(),s.find(".plyr__controls").hide()}),l.push(r),t.data("plyr-initialized",!0),t.data("video-mode",n),t.data("play-state",i.STOPPED),w(e,r,o)}function w(t,a,e){let o=t.closest('[data-plyr="component"]').find('[data-plyr="overlay"]');if(!e.showOverlay){o.hide();return}o.on("click",function(){let r=t.find(".plyr_video");p(r),r.data("play-state",i.FULL),r.attr("data-user-controlled","true"),o.hide(),t.find(".plyr__controls").show(),a.muted=!1,a.restart(),a.play()}),t.on("click",function(r){!$(r.target).closest(".plyr__controls").length&&!$(r.target).closest('[data-plyr="overlay"]').length&&t.find(".plyr_video").data("play-state")===i.FULL&&(a.playing?a.pause():a.play())})}function c(t){if(t.attr("data-user-controlled")==="true")return;if(!t.data("plyr-initialized")){let e=t.parent().attr("data-video-mode")||"preview";d(t,e)}let a=l.find(e=>e.media===t[0]);a&&(t.data("play-state",i.PREVIEW),a.muted=!0,a.play().catch(()=>{}))}function S(t){if(!t.data("plyr-initialized")){let e=t.parent().attr("data-video-mode")||"preview";d(t,e)}let a=l.find(e=>e.media===t[0]);if(a){let e=t.closest(".plyr"),o=e.closest('[data-plyr="component"]').find('[data-plyr="overlay"]');p(t),t.data("play-state",i.FULL),t.attr("data-user-controlled","true"),o.hide(),e.find(".plyr__controls").show(),a.muted=!1,a.restart(),a.play()}}function P(t){if(t.attr("data-user-controlled")==="true")return;let a=l.find(e=>e.media===t[0]);a&&t.data("play-state")===i.PREVIEW&&(a.pause(),a.restart(),t.data("play-state",i.STOPPED),t.parent().closest('[data-plyr="component"]').find('[data-plyr="overlay"]').show())}function p(t=null){l.forEach(a=>{let e=$(a.media);if(t&&e[0]===t[0])return;let n=e.data("play-state");if(n===i.PREVIEW||n===i.FULL){a.pause(),a.restart(),a.muted=!0,e.data("play-state",i.STOPPED),e.removeAttr("data-user-controlled");let r=e.parent().closest('[data-plyr="component"]');r.find('[data-plyr="overlay"]').show(),r.find(".plyr__controls").hide()}})}function _(t,a="preview"){let e=!1;$(document).on("click",".swiper-arrow.prev.is-testimonials-2, .swiper-arrow.next.is-testimonials-2",function(){e=!0}),t.on("slideChange",function(){setTimeout(()=>{let n=this.slides[this.activeIndex],o=$(n).find(".plyr_video");o.length&&o.attr("data-user-controlled")!=="true"&&c(o)},100)}),t.on("afterInit",function(){$(this.slides).each(function(){let n=$(this).find(".plyr_video");n.length&&y(n)}),setTimeout(()=>{let n=this.slides[this.activeIndex],o=$(n).find(".plyr_video");o.length&&c(o)},300)}),t.initialized&&($(t.slides).each(function(){let n=$(this).find(".plyr_video");n.length&&y(n)}),setTimeout(()=>{let n=t.slides[t.activeIndex],o=$(n).find(".plyr_video");o.length&&c(o)},300))}$(document).ready(()=>h());})();
